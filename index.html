<!DOCTYPE html>
<html>
  <head></head>
  <body>



<br><br>
<button id="show_pdf" onclick="show_pdf()">show_pdf</button>
<br><br>


<object style="display:none" data="document.pdf" type="application/pdf" width="800" height="1200"></object>

	  
<script>

// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe
// https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Other_embedding_technologies
var objectElement = document.createElement('object');
objectElement.setAttribute("type", "application/pdf");
objectElement.setAttribute("width", 800);
objectElement.setAttribute("height", 1200);


const repoOwner = 'CodeSolutions2';
const repoName = 'pdf_to_text_webapp';

// ----------------------------------------------------

async function show_pdf() {
  
  await GET_text_from_file_wo_auth_GitHub_RESTAPI()
    .then(async function(file_objects) {
	    console.log('file_objects: ', file_objects);
	    // iframeElement.src = file_objects.at(0).html_url; // Firefox Can’t Open This Page in the iframe, displays a button 'open site in new window'. It opens file in new window on github server.
	    // iframeElement.src = file_objects.at(0).download_url; // iframe is empty, it changes to a new window, and automatically downloads the file to the pc
	    // objectElement.data = file_objects.at(0).html_url;  // nothing appears
	    
	    // objectElement.setAttribute("data", file_objects.at(0).download_url); // The loading of “https://raw.githubusercontent.com/CodeSolutions2/pdf_to_text_webapp/main/document.pdf” in a frame is denied by “X-Frame-Options“ directive set to “deny“.

	    objectElement.setAttribute("data", file_objects.at(0).html_url);
	    
	    document.body.appendChild(objectElement);
    })
  
}

// ----------------------------------------------------
	
async function GET_text_from_file_wo_auth_GitHub_RESTAPI() {
	
	var url = `https://api.github.com/repos/${repoOwner}/${repoName}/contents`;
	var file_objects = [];
	
	return await fetch(url)
		.then(res => res.json())
		.then(data => { 
			data.forEach(async function(file) {
				if (file.type === 'file' && file.name.match(/.(pdf)$/i)) {
					file_objects.push(file);
				}
			});
			return file_objects;
		})
		.catch(error => { console.log(error); });
}

// ----------------------------------------------------

  
</script>

  </body>
</html>
