<!DOCTYPE html>
<html>
  <head></head>
  <body>

<h1>An example of extracting text from a pdf</h1> 
<br><br>
<button id="show_pdf" onclick="show_pdf()">show_pdf</button>

<!-- <object style="display:none" data="document.pdf" type="application/pdf" width="800" height="1200"></object> -->

<!-- View text results -->
<div id="output" style="display:none;font-family:courier;font-size:24px;height:300px"></div>



<script>

const outp = document.getElementById('output');

// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe
// https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Other_embedding_technologies
var objectElement = document.createElement('object');
objectElement.setAttribute("type", "application/pdf");
objectElement.setAttribute("width", 800);
objectElement.setAttribute("height", 1200);

const repoOwner = 'CodeSolutions2';
const repoName = 'pdf_to_text_webapp';

// ----------------------------------------------------

async function show_pdf() {
  
  await GET_text_from_file_wo_auth_GitHub_RESTAPI()
    .then(async function(file_objects) {
	    // console.log('file_objects: ', file_objects);

	    outp.innerHTML = file_objects.at(0).download_url;
	
	    objectElement.setAttribute("data", file_objects.at(0).name);
	    // one needs to only put the name of the pdf, instead of the full html_url because the fetch labels the data as cross-site instead of same-site
	    document.body.appendChild(objectElement);
    })
  
}

	
// ----------------------------------------------------
	
async function GET_text_from_file_wo_auth_GitHub_RESTAPI() {
	
	var url = `https://api.github.com/repos/${repoOwner}/${repoName}/contents`;
	var file_objects = [];
	
	return await fetch(url)
		.then(res => res.json())
		.then(data => { 
			data.forEach(async function(file) {
				if (file.type === 'file' && file.name.match(/.(pdf)$/i)) {
					file_objects.push(file);
				}
			});
			return file_objects;
		})
		.catch(error => { console.log(error); });
}

// ----------------------------------------------------

  
</script>

  </body>
</html>
